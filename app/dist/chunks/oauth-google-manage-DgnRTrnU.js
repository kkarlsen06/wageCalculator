import{s as l}from"./supabase-client-C25D-rrn.js";async function h(){const{data:{user:n},error:o}=await l.auth.getUser();if(o)throw o;const t=n?.identities||[],i=t.some(e=>e.provider==="google"),r=t.some(e=>e.provider==="email"),s=t.filter(e=>e.provider!=="google");return{user:n,identities:t,hasGoogle:i,hasEmail:r,otherProviders:s}}async function g(){const{user:n,identities:o,hasGoogle:t,hasEmail:i,otherProviders:r}=await h();if(!t)return{ok:!1,reason:"not_linked"};if(!(i||r&&r.length>0))return{ok:!1,reason:"no_alternative"};const e=o.find(d=>d.provider==="google"),{error:a}=await l.auth.unlinkIdentity(e);if(a)throw a;return{ok:!0}}export{h as getAuthSnapshot,g as unlinkGoogleIdentity};
